"use strict";(self["webpackChunkims"]=self["webpackChunkims"]||[]).push([[9420],{9420:(e,t,l)=>{l.r(t),l.d(t,{default:()=>C});var a=l(3673),o=l(2323),s=l(8880);const i={class:"q-pa-xl"},n={class:"q-pa-md"},r={class:"row q-gutter-md q-pa-md"},d={class:"q-pl-sm"},u={key:0},p=(0,a.Uk)(" Items are not Delivered "),m={class:"col-2 q-table__title"},c={key:0,class:"col"},h={key:0},w={key:0},v={class:"row q-gutter-md"};function b(e,t,l,b,f,y){const g=(0,a.up)("PurchaseHeader"),_=(0,a.up)("DeleteDialogBox"),P=(0,a.up)("q-item"),R=(0,a.up)("q-btn"),k=(0,a.up)("q-space"),x=(0,a.up)("q-toggle"),N=(0,a.up)("q-select"),D=(0,a.up)("q-td"),U=(0,a.up)("q-input"),q=(0,a.up)("q-popup-edit"),V=(0,a.up)("q-tr"),W=(0,a.up)("q-table");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",i,[(0,a.Wm)(g)]),(0,a._)("div",n,[(0,a.Wm)(_,{onResponse:y.getResponse,ref:"confirmbox"},null,8,["onResponse"]),(0,a._)("div",r,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.GRN,((e,t)=>((0,a.wg)(),(0,a.j4)(P,{key:t},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(t)+": ",1),(0,a._)("span",d,[(0,a._)("b",null,(0,o.zw)(e),1)])])),_:2},1024)))),128)),f.GRN.Delivered?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",u,[p,(0,a.Wm)(R,{to:{name:"ship-grn",params:{GRNNO:this.$route.params.GRNNO}},flat:"",color:"negative",icon:"local_shipping",label:"Deliver"},null,8,["to"])]))]),(0,a.Wm)(W,{title:f.title,rows:f.rows,columns:f.columns,"row-key":"name","visible-columns":f.visibleColumns,loading:f.loading,color:"secondary","no-data-label":"There is No Purchase Under this GRN","rows-per-page-options":[]},{top:(0,a.w5)((l=>[(0,a._)("div",m,(0,o.zw)(f.title),1),(0,a.Wm)(k),e.$q.screen.gt.xs?((0,a.wg)(),(0,a.iD)("div",c,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(y.toogle_columns,(e=>((0,a.wg)(),(0,a.j4)(P,{style:{display:"inline"},key:e},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{modelValue:f.visibleColumns,"onUpdate:modelValue":t[0]||(t[0]=e=>f.visibleColumns=e),val:e.name,label:e.label,color:"secondary"},null,8,["modelValue","val","label"])])),_:2},1024)))),128))])):((0,a.wg)(),(0,a.j4)(N,{key:1,color:"secondary",modelValue:f.visibleColumns,"onUpdate:modelValue":t[1]||(t[1]=e=>f.visibleColumns=e),multiple:"",borderless:"",dense:"","options-dense":"","display-value":e.$q.lang.table.columns,"emit-value":"","map-options":"",options:f.columns,"option-value":"name",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"])),(0,a.Wm)(R,{color:"secondary","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:y.exportTable},null,8,["onClick"]),(0,a.Wm)(R,{flat:"",round:"",dense:"",icon:l.inFullscreen?"fullscreen_exit":"fullscreen",onClick:l.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])])),body:(0,a.w5)((e=>[(0,a.Wm)(V,{props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{key:"PurchaseID",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.PurchaseID),1)])),_:2},1032,["props"]),(0,a.Wm)(D,{key:"ItemType",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.ItemType),1)])),_:2},1032,["props"]),(0,a.Wm)(D,{key:"PPP",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.PPP),1)])),_:2},1032,["props"]),(0,a.Wm)(D,{key:"Quantity",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.Quantity),1)])),_:2},1032,["props"]),(0,a.Wm)(D,{key:"Total",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.Total),1)])),_:2},1032,["props"]),(0,a.Wm)(D,{key:"Remainder",props:e},{default:(0,a.w5)((()=>[f.GRN.Delivered?((0,a.wg)(),(0,a.iD)("div",h,[(0,a.Uk)((0,o.zw)(e.row.Remainder)+" ",1),(0,a.Wm)(q,{modelValue:e.row.Remainder,"onUpdate:modelValue":t=>e.row.Remainder=t,title:"Update Remainder",buttons:"",persistent:"",validate:t=>y.update_purchase({key:"Remainder",value:t},f.rows.indexOf(e.row)),"label-set":"Update",color:"secondary",class:"text-secondary"},{default:(0,a.w5)((e=>[(0,a.Wm)(U,{color:"secondary",type:"number",modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,modelModifiers:{number:!0},dense:"",autofocus:"",onKeyup:(0,s.D2)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])),_:2},1032,["modelValue","onUpdate:modelValue","validate"])])):(0,a.kq)("",!0)])),_:2},1032,["props"]),(0,a.Wm)(D,{key:"Extra",props:e},{default:(0,a.w5)((()=>[f.GRN.Delivered?((0,a.wg)(),(0,a.iD)("div",w,[(0,a.Uk)((0,o.zw)(e.row.Extra)+" ",1),(0,a.Wm)(q,{modelValue:e.row.Extra,"onUpdate:modelValue":t=>e.row.Extra=t,title:"Update Extra",buttons:"",persistent:"",validate:t=>y.update_purchase({key:"Extra",value:t},f.rows.indexOf(e.row)),"label-set":"Update",color:"secondary",class:"text-secondary"},{default:(0,a.w5)((e=>[(0,a.Wm)(U,{color:"secondary",type:"number",modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,modelModifiers:{number:!0},dense:"",autofocus:"",onKeyup:(0,s.D2)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])),_:2},1032,["modelValue","onUpdate:modelValue","validate"])])):(0,a.kq)("",!0)])),_:2},1032,["props"]),(0,a.Wm)(D,{key:"action",props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(R,{color:"negative","icon-right":"delete","no-caps":"",flat:"",dense:"",onClick:t=>y.show_dialog_box(f.rows.indexOf(e.row))},null,8,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),bottom:(0,a.w5)((()=>[(0,a._)("div",v,[(0,a._)("div",null,[(0,a.Wm)(R,{to:{name:"print",params:{user:y.printable_data}},color:"secondary",icon:"print",label:"Print"},null,8,["to"])])])])),_:1},8,["title","rows","columns","visible-columns","loading"])])],64)}var f=l(2841),y=l(6966),g=l(4107),_=l(5547),P=l(7428);const R={name:"GRNDetail",components:{DeleteDialogBox:y.Z,PurchaseHeader:g.Z},data(){return{loading:!1,title:"Purchased Items",visibleColumns:["ItemType","PPP","Quantity","Total","Remainder","Extra"],columns:[{name:"PurchaseID",label:"Purchase ID",field:"PurchaseID",align:"left",sortable:!0,required:!0},{name:"ItemType",label:"Item Type",field:"ItemType",sortable:!0},{name:"PPP",label:"Price",field:"PPP",sortable:!0},{name:"Quantity",label:"Quantity",field:"Quantity",sortable:!0},{name:"Total",label:"Total",field:"Total",sortable:!0},{name:"Remainder",label:"Remainder",field:"Remainder",sortable:!0},{name:"Extra",label:"Extra",field:"Extra",sortable:!0},{name:"action",label:"Action",field:"action",required:!0}],rows:[],selected_index:null,GRN:{}}},computed:{toogle_columns(){return this.columns.filter((e=>!0!==e.required))},printable_data(){var e={title:"Good Recieving Note",table_tittle:"Purchased Items",header_data:this.GRN,columns:this.columns,rows:this.rows};return JSON.stringify(e)}},methods:{validate_GRN(){(0,_.pW)(this.$route.params.GRNNO).then((e=>{this.GRN=e.data,this.fetchRows()})).catch((e=>{this.$router.push({name:"purchases"})}))},fetchRows(){(0,_.Pw)(this.$route.params.GRNNO).then((e=>{this.rows=e.data,this.loading=!1})).catch((e=>{this.loading=!1}))},getResponse(e){if(e){const e={PurchaseID:this.rows[this.selected_index].PurchaseID,GRNNO:this.rows[this.selected_index].GRNNO};(0,_.uU)(e).then((e=>{(0,P.U)(e.data.message,"positive","top"),this.rows.splice(this.selected_index,1),this.selected_index=null,this.$refs.confirmbox.response=!1,this.validate_GRN()})).catch((e=>{(0,P.j)(e.response.data.message,"negative","top")}))}},update_purchase(e,t){var l=this.rows[t],a=e;l[a.key]=a.value;const o={PPP:l.PPP,Quantity:l.Quantity,Remainder:l.Remainder,Extra:l.Extra,PurchaseID:l.PurchaseID,GRNNO:l.GRNNO};o.PPP<1?((0,P.j)("Price cant be less than 1"),this.rows=[],this.fetchRows()):o.Quantity<1?((0,P.j)("Quantity cant be less than 1"),this.rows=[],this.fetchRows()):(0,_.CD)(o).then((e=>((0,P.U)(e.data.message,"positive","top"),this.rows=[],this.fetchRows(),!0))).catch((e=>((0,P.j)(e.response.data.message,"negative","top"),this.rows=[],this.fetchRows(),!1)))},show_dialog_box(e){this.$refs.confirmbox.message=`${this.rows[e].ItemType} `,this.$refs.confirmbox.confirm=!0,this.selected_index=e},wrapCsvValue(e,t){let l=void 0!==t?t(e):e;return l=void 0===l||null===l?"":String(l),l=l.split('"').join('""'),`"${l}"`},exportTable(){const e=[this.columns.map((e=>this.wrapCsvValue(e.label)))].concat(this.rows.map((e=>this.columns.map((t=>this.wrapCsvValue("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format))).join(",")))).join("\r\n"),t=(0,f.Z)("table-export.csv",e,"text/csv");!0!==t&&(0,P.j)("Browser denied file download...")}},mounted(){this.validate_GRN()}};var k=l(3414),x=l(2165),N=l(3243),D=l(2025),U=l(8886),q=l(8516),V=l(8186),W=l(3884),G=l(1289),I=l(4842),Q=l(7518),T=l.n(Q);R.render=b;const C=R;T()(R,"components",{QItem:k.Z,QBtn:x.Z,QTable:N.Z,QSpace:D.Z,QToggle:U.Z,QSelect:q.Z,QTr:V.Z,QTd:W.Z,QPopupEdit:G.Z,QInput:I.Z})}}]);