"use strict";(self["webpackChunkims"]=self["webpackChunkims"]||[]).push([[7134],{7134:(e,a,o)=>{o.r(a),o.d(a,{default:()=>$});var l=o(3673),t=o(2323),s=o(8880);const r={class:"q-pa-lg q-ma-lg col q-gutter-md"},n={class:"row q-gutter-md"},i={class:"row items-center justify-end"},d={class:"row items-center justify-end"},p={class:"row justify-center"},m={class:"q-pa-lg q-mt-lg"},u={class:"col-2 q-table__title"},c={key:0,class:"col"},w=(0,l.Uk)(" Settle Credit "),f=(0,l.Uk)(" List SOLD Items ");function h(e,a,o,h,_,g){const v=(0,l.up)("SalesHeader"),y=(0,l.up)("q-input"),D=(0,l.up)("q-btn"),b=(0,l.up)("q-date"),N=(0,l.up)("q-popup-proxy"),C=(0,l.up)("q-icon"),V=(0,l.up)("q-select"),k=(0,l.up)("DeleteDialogBox"),W=(0,l.up)("q-space"),q=(0,l.up)("q-toggle"),U=(0,l.up)("q-item"),T=(0,l.up)("q-td"),x=(0,l.up)("q-popup-edit"),R=(0,l.up)("q-badge"),O=(0,l.up)("q-tooltip"),S=(0,l.up)("q-tr"),E=(0,l.up)("q-table"),Z=(0,l.up)("q-page"),F=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(Z,{padding:""},{default:(0,l.w5)((()=>[(0,l.Wm)(v),(0,l._)("div",r,[(0,l._)("div",n,[(0,l.Wm)(y,{color:"secondary",modelValue:_.search_data.REFNO,"onUpdate:modelValue":a[0]||(a[0]=e=>_.search_data.REFNO=e),type:"number",label:"Reference Number",outlined:"",filled:""},null,8,["modelValue"]),(0,l.Wm)(y,{color:"secondary",label:"Date-Range 1",filled:"",modelValue:_.search_data.D1,"onUpdate:modelValue":a[2]||(a[2]=e=>_.search_data.D1=e)},{prepend:(0,l.w5)((()=>[(0,l.Wm)(C,{name:"event",class:"cursor-pointer"},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{"transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{color:"secondary",modelValue:_.search_data.D1,"onUpdate:modelValue":a[1]||(a[1]=e=>_.search_data.D1=e),mask:"YYYY-MM-DD"},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.wy)((0,l.Wm)(D,{label:"Close",color:"secondary",flat:""},null,512),[[F]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(y,{color:"secondary",label:"Date-Range 2",filled:"",modelValue:_.search_data.D2,"onUpdate:modelValue":a[4]||(a[4]=e=>_.search_data.D2=e)},{prepend:(0,l.w5)((()=>[(0,l.Wm)(C,{name:"event",class:"cursor-pointer"},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{"transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{color:"secondary",modelValue:_.search_data.D2,"onUpdate:modelValue":a[3]||(a[3]=e=>_.search_data.D2=e),mask:"YYYY-MM-DD"},{default:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l.wy)((0,l.Wm)(D,{label:"Close",color:"secondary",flat:""},null,512),[[F]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(y,{color:"secondary",modelValue:_.search_data.CustomerName,"onUpdate:modelValue":a[5]||(a[5]=e=>_.search_data.CustomerName=e),type:"text",label:"CustomerName",outlined:"",filled:""},null,8,["modelValue"]),(0,l.Wm)(V,{color:"secondary",style:{width:"200px"},modelValue:_.search_data.order,"onUpdate:modelValue":a[6]||(a[6]=e=>_.search_data.order=e),options:["Ascending ","Descending "],label:"Order Type",filled:""},null,8,["modelValue"])]),(0,l._)("div",p,[(0,l.Wm)(D,{color:"secondary",icon:"search",flat:"",label:"Search",onClick:g.search},null,8,["onClick"]),(0,l.Wm)(D,{color:"negative",icon:"check",flat:"",label:"reset",onClick:g.reset},null,8,["onClick"])])]),(0,l._)("div",m,[(0,l.Wm)(k,{onResponse:g.getResponse,ref:"confirmbox"},null,8,["onResponse"]),(0,l.Wm)(E,{title:_.title,rows:_.rows,columns:_.columns,"row-key":"name","visible-columns":_.visibleColumns,loading:_.loading,color:"secondary","no-data-label":"No Purchased Data",pagination:_.pagination,"onUpdate:pagination":a[9]||(a[9]=e=>_.pagination=e),onRequest:g.handleRequest,"rows-per-page-options":[]},{top:(0,l.w5)((o=>[(0,l._)("div",u,(0,t.zw)(_.title),1),(0,l.Wm)(W),e.$q.screen.gt.xs?((0,l.wg)(),(0,l.iD)("div",c,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(g.toogle_columns,(e=>((0,l.wg)(),(0,l.j4)(U,{style:{display:"inline"},key:e},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{modelValue:_.visibleColumns,"onUpdate:modelValue":a[7]||(a[7]=e=>_.visibleColumns=e),val:e.name,label:e.label,color:"secondary"},null,8,["modelValue","val","label"])])),_:2},1024)))),128))])):((0,l.wg)(),(0,l.j4)(V,{key:1,color:"secondary",modelValue:_.visibleColumns,"onUpdate:modelValue":a[8]||(a[8]=e=>_.visibleColumns=e),multiple:"",borderless:"",dense:"","options-dense":"","display-value":e.$q.lang.table.columns,"emit-value":"","map-options":"",options:_.columns,"option-value":"name",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"])),(0,l.Wm)(D,{color:"secondary","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:g.exportTable},null,8,["onClick"]),(0,l.Wm)(D,{flat:"",round:"",dense:"",icon:o.inFullscreen?"fullscreen_exit":"fullscreen",onClick:o.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])])),body:(0,l.w5)((e=>[(0,l.Wm)(S,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{key:"REFNO",props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.row.REFNO),1)])),_:2},1032,["props"]),(0,l.Wm)(T,{class:"editable",key:"SalesDate",props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.row.SalesDate),1)])),_:2},1032,["props"]),(0,l.Wm)(T,{class:"editable",key:"CustomerName",props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.row.CustomerName)+" ",1),(0,l.Wm)(x,{modelValue:e.row.CustomerName,"onUpdate:modelValue":a=>e.row.CustomerName=a,title:"Update Customer",buttons:"",persistent:"",validate:a=>g.update_ref({key:"CustomerName",value:a},_.rows.indexOf(e.row)),"label-set":"Update",color:"secondary",class:"text-secondary"},{default:(0,l.w5)((e=>[(0,l.Wm)(V,{color:"secondary",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,hint:"select Customer",options:_.customer_options.map((e=>e.CustomerName)),label:"Customer",dense:"",autofocus:"",onKeyup:(0,s.D2)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","options","onKeyup"])])),_:2},1032,["modelValue","onUpdate:modelValue","validate"])])),_:2},1032,["props"]),(0,l.Wm)(T,{key:"TransactionType",props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(R,{color:"Cash"===e.row.TransactionType?"orange":"blue","text-color":"{2:black}",label:e.row.TransactionType},null,8,["color","label"])])),_:2},1032,["props"]),(0,l.Wm)(T,{class:"editable",key:"DriverName",props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.row.DriverName)+" ",1),(0,l.Wm)(x,{modelValue:e.row.DriverName,"onUpdate:modelValue":a=>e.row.DriverName=a,title:"Update Driver Name",buttons:"",persistent:"",validate:a=>g.update_ref({key:"DriverName",value:a},_.rows.indexOf(e.row)),"label-set":"Update",color:"secondary",class:"text-secondary"},{default:(0,l.w5)((e=>[(0,l.Wm)(V,{color:"secondary",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,hint:"select Driver",options:_.drivers_options.map((e=>e.DriverName)),label:"Driver",dense:"",autofocus:"",onKeyup:(0,s.D2)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","options","onKeyup"])])),_:2},1032,["modelValue","onUpdate:modelValue","validate"])])),_:2},1032,["props"]),(0,l.Wm)(T,{key:"EmployeeName",props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.row.EmployeeName),1)])),_:2},1032,["props"]),(0,l.Wm)(T,{key:"Total",props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.row.Total),1)])),_:2},1032,["props"]),(0,l.Wm)(T,{key:"Description",props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.row.Description)+" ",1),(0,l.Wm)(x,{modelValue:e.row.Description,"onUpdate:modelValue":a=>e.row.Description=a,modelModifiers:{number:!0},title:"Update Purchase Description",buttons:"",persistent:"",validate:a=>g.update_ref({key:"Description",value:a},_.rows.indexOf(e.row)),"label-set":"Update",color:"secondary",class:"text-secondary"},{default:(0,l.w5)((e=>[(0,l.Wm)(y,{color:"secondary",type:"text",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,dense:"",autofocus:"",onKeyup:(0,s.D2)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])),_:2},1032,["modelValue","onUpdate:modelValue","validate"])])),_:2},1032,["props"]),(0,l.Wm)(T,{key:"CreditSettlement",props:e},{default:(0,l.w5)((()=>["Credit"==e.row.TransactionType?((0,l.wg)(),(0,l.j4)(D,{key:0,color:"blue","icon-right":"payments","no-caps":"",flat:"",to:{name:"ref-credit-detail",params:{REFNO:e.row.REFNO}},dense:""},{default:(0,l.w5)((()=>[(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[w])),_:1})])),_:2},1032,["to"])):(0,l.kq)("",!0)])),_:2},1032,["props"]),(0,l.Wm)(T,{key:"Delete",props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{color:"positive","icon-right":"open_in_new","no-caps":"",flat:"",dense:"",to:{name:"ref-detail",params:{REFNO:e.row.REFNO}}},{default:(0,l.w5)((()=>[(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[f])),_:1})])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,l.Wm)(T,{key:"Delete",props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{color:"negative","icon-right":"delete","no-caps":"",flat:"",dense:"",onClick:a=>g.show_dialog_box(_.rows.indexOf(e.row))},null,8,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["title","rows","columns","visible-columns","loading","pagination","onRequest"])])])),_:1})}var _=o(7302),g=o(6966),v=o(2841),y=o(5616),D=o(2530),b=o(8554),N=o(2986),C=o(7428);const V={name:"Sales",components:{SalesHeader:_.Z,DeleteDialogBox:g.Z},data(){return{pagination:{descending:!1,page:1,rowsPerPage:2},TransactionType:[{ID:1,Type:"Cash"},{ID:2,Type:"Credit"}],loading:!0,title:"Sales",rows:[],visibleColumns:["SalesDate","CustomerName","TransactionType","DriverName","EmployeeName"],columns:[{name:"REFNO",label:"REFNO",field:"REFNO",align:"left",sortable:!0,required:!0},{name:"SalesDate",label:"Sales Date",field:"SalesDate",align:"center",sortable:!0},{name:"CustomerName",label:"Customer Name",field:"CustomerName",align:"center",sortable:!0},{name:"TransactionType",label:"Transaction Type",field:"TransactionType",sortable:!0,align:"center"},{name:"DriverName",label:"Driver Name",field:"DriverName",sortable:!0,align:"center"},{name:"EmployeeName",label:"Sold BY",field:"EmployeeName",sortable:!0,align:"center"},{name:"Total",label:"Total Amount ",field:"Total",required:!0,align:"center"},{name:"Description",label:"Description",field:"Description",align:"center"},{name:"CreditSettlement",label:"Credit Settlement",field:"CreditSettlement",required:!0,align:"center"},{name:"SoldItems",label:"Sold Items",field:"SoldItems",align:"center",required:!0},{name:"Delete",label:"Delete",field:"Delete",required:!0,align:"center"}],customer_options:[],drivers_options:[],search_data:{page:1,REFNO:"",D1:"",D2:"",CustomerName:"",order:"Descending"}}},computed:{toogle_columns(){return this.columns.filter((e=>!0!==e.required))}},methods:{handleRequest(e){this.fetch_rows(e.pagination.page)},reset(){this.search_data={page:1,REFNO:"",D1:"",D2:"",CustomerName:"",order:"Descending"},this.fetch_rows(1)},search(){this.fetch_rows(1)},request_data_builder(e){var a=this.search_data;return a.page=e,a},fetch_rows(e){(0,N.X8)(this.request_data_builder(e)).then((e=>{const a=e.data.meta_data;this.pagination.page=a.current_page,this.pagination.rowsPerPage=a.per_page,this.pagination.rowsNumber=a.total,this.rows=e.data.data,this.loading=!1})).catch((e=>{this.rows=[],this.rows=e.response.data.data,this.loading=!1}))},date_fromat(e){return y.ZP.formatDate(e,"YYYY-MM-DD HH:mm")},getResponse(e){if(e){const e={REFNO:this.rows[this.selected_index].REFNO};(0,N.Wc)(e).then((e=>{(0,C.U)(e.data.message,"positive","top"),this.rows.splice(this.selected_index,1),this.selected_index=null,this.$refs.confirmbox.response=!1})).catch((e=>{(0,C.j)(e.response.data.message,"negative","top")}))}},update_ref(e,a){var o=this.rows[a],l=e;o[l.key]=l.value;var t=this.drivers_options.find((e=>e.DriverName===o.DriverName));const s={SoldDate:o.SalesDate,CustomerID:this.customer_options.find((e=>e.CustomerName===o.CustomerName)).CustomerID,DriverID:t?t.DriverID:"",REFNO:o.REFNO,Description:o.Description};(0,N.PD)(s).then((e=>((0,C.U)(e.data.message,"positive","top"),!0))).catch((e=>((0,C.j)(e.response.data.message,"negative","top"),this.rows=[],this.fetch_rows(props.pagination.page),!1)))},show_dialog_box(e){this.$refs.confirmbox.message=`Reference NO ${this.rows[e].REFNO} `,this.$refs.confirmbox.confirm=!0,this.selected_index=e},wrapCsvValue(e,a){let o=void 0!==a?a(e):e;return o=void 0===o||null===o?"":String(o),o=o.split('"').join('""'),`"${o}"`},exportTable(){const e=[this.columns.map((e=>this.wrapCsvValue(e.label)))].concat(this.rows.map((e=>this.columns.map((a=>this.wrapCsvValue("function"===typeof a.field?a.field(e):e[void 0===a.field?a.name:a.field],a.format))).join(",")))).join("\r\n"),a=(0,v.Z)("table-export.csv",e,"text/csv");!0!==a&&(0,C.j)("Browser denied file download...")}},mounted(){this.fetch_rows(1),(0,D.OL)().then((e=>{this.customer_options=e.data})).catch((e=>{this.customer_options=[]})),(0,b.jT)().then((e=>{this.drivers_options=e.data})).catch((e=>{}))}};var k=o(4379),W=o(4842),q=o(4554),U=o(3944),T=o(2651),x=o(2165),R=o(8516),O=o(3243),S=o(2025),E=o(3414),Z=o(8886),F=o(8186),Q=o(3884),j=o(1289),I=o(5990),Y=o(9721),P=o(8870),z=o(677),K=o(7518),M=o.n(K);V.render=h,V.__scopeId="data-v-b4da9988";const $=V;M()(V,"components",{QPage:k.Z,QInput:W.Z,QIcon:q.Z,QPopupProxy:U.Z,QDate:T.Z,QBtn:x.Z,QSelect:R.Z,QTable:O.Z,QSpace:S.Z,QItem:E.Z,QToggle:Z.Z,QTr:F.Z,QTd:Q.Z,QPopupEdit:j.Z,QTime:I.Z,QBadge:Y.Z,QTooltip:P.Z}),M()(V,"directives",{ClosePopup:z.Z})}}]);