"use strict";(self["webpackChunkims"]=self["webpackChunkims"]||[]).push([[760],{760:(e,o,t)=>{t.r(o),t.d(o,{default:()=>W});var l=t(3673),s=t(2323),a=t(8880);const n={class:"q-pa-md"},i={class:"row q-gutter-md q-pa-md"},r={class:"q-pl-sm"},d={class:"row-12"},u={class:"col-2 q-table__title"},p={key:0,class:"col"};function c(e,o,t,c,m,w){const f=(0,l.up)("DeleteDialogBox"),h=(0,l.up)("q-item"),v=(0,l.up)("q-space"),b=(0,l.up)("q-toggle"),g=(0,l.up)("q-select"),D=(0,l.up)("q-btn"),y=(0,l.up)("q-td"),_=(0,l.up)("q-date"),C=(0,l.up)("q-popup-edit"),x=(0,l.up)("q-input"),I=(0,l.up)("q-tr"),k=(0,l.up)("q-table");return(0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(f,{onResponse:w.getResponse,ref:"confirmbox"},null,8,["onResponse"]),(0,l._)("div",i,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.TransferExpense,((e,o)=>((0,l.wg)(),(0,l.j4)(h,{key:o},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(o)+": ",1),(0,l._)("span",r,[(0,l._)("b",null,(0,s.zw)(e),1)])])),_:2},1024)))),128))]),(0,l.Wm)(k,{title:m.title,rows:m.rows,columns:m.columns,"row-key":"name","visible-columns":m.visibleColumns,loading:m.loading,color:"secondary","no-data-label":"There is No Purchase Under this GRN"},{top:(0,l.w5)((t=>[(0,l._)("div",d,[(0,l._)("div",u,(0,s.zw)(m.title),1)]),(0,l.Wm)(v),e.$q.screen.gt.xs?((0,l.wg)(),(0,l.iD)("div",p,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.toogle_columns,(e=>((0,l.wg)(),(0,l.j4)(h,{style:{display:"inline"},key:e},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{modelValue:m.visibleColumns,"onUpdate:modelValue":o[0]||(o[0]=e=>m.visibleColumns=e),val:e.name,label:e.label,color:"secondary"},null,8,["modelValue","val","label"])])),_:2},1024)))),128))])):((0,l.wg)(),(0,l.j4)(g,{key:1,color:"secondary",modelValue:m.visibleColumns,"onUpdate:modelValue":o[1]||(o[1]=e=>m.visibleColumns=e),multiple:"",borderless:"",dense:"","options-dense":"","display-value":e.$q.lang.table.columns,"emit-value":"","map-options":"",options:m.columns,"option-value":"name",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"])),(0,l.Wm)(D,{color:"secondary","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:w.exportTable},null,8,["onClick"]),(0,l.Wm)(D,{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen",onClick:t.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])])),body:(0,l.w5)((e=>[(0,l.Wm)(I,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{key:"TEID",props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{color:"orange","icon-right":"open_in_new","no-caps":"",flat:"",dense:"",label:e.row.TEID,to:{name:"transfer-detail",params:{TEID:e.row.TEID}}},null,8,["label","to"])])),_:2},1032,["props"]),(0,l.Wm)(y,{class:"editable",key:"Date",props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.row.Date)+" ",1),(0,l.Wm)(C,{modelValue:e.row.Date,"onUpdate:modelValue":o=>e.row.Date=o,title:"Update Date",buttons:"",persistent:"",validate:o=>w.update_te({key:"Date",value:o},m.rows.indexOf(e.row)),"label-set":"Update",color:"secondary",class:"text-black"},{default:(0,l.w5)((e=>[(0,l.Wm)(_,{modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,color:"secondary",minimal:"",dense:"",autofocus:"",onKeyup:(0,a.D2)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])),_:2},1032,["modelValue","onUpdate:modelValue","validate"])])),_:2},1032,["props"]),(0,l.Wm)(y,{key:"INCount",props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.row.INCount)+" ",1),(0,l.Wm)(C,{modelValue:e.row.INCount,"onUpdate:modelValue":o=>e.row.INCount=o,title:"Update Count",buttons:"",persistent:"",validate:o=>w.update_transfered_count({key:"INCount",value:o},m.rows.indexOf(e.row)),"label-set":"Update",color:"secondary",class:"text-secondary"},{default:(0,l.w5)((e=>[(0,l.Wm)(x,{color:"secondary",type:"number",modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,modelModifiers:{number:!0},dense:"",autofocus:"",onKeyup:(0,a.D2)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])),_:2},1032,["modelValue","onUpdate:modelValue","validate"])])),_:2},1032,["props"]),(0,l.Wm)(y,{key:"action",props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{color:"negative","icon-right":"delete","no-caps":"",flat:"",dense:"",onClick:o=>w.show_dialog_box(m.rows.indexOf(e.row))},null,8,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["title","rows","columns","visible-columns","loading"])])}var m=t(2841),w=t(6966),f=t(1121),h=t(7428);const v={name:"TransferHistory",components:{DeleteDialogBox:w.Z},data(){return{loading:!1,visibleColumns:["Date","INCount"],columns:[{name:"TEID",label:"TEID",field:"TEID",align:"left",required:!0},{name:"Date",label:"Date",field:"Date",align:"center"},{name:"INCount",label:"Total Transfered Count",field:"INCount",align:"center"},{name:"action",label:"Delete",field:"action",required:!0}],rows:[],selected_index:null,categories:[],TransferExpense:{},title:""}},computed:{toogle_columns(){return this.columns.filter((e=>!0!==e.required))}},methods:{fetchRows(){(0,f.b2)(this.$route.params.ItemID).then((e=>{this.rows=e.data,this.title=" Transfer History for "+this.rows[0].ItemType,this.loading=!1})).catch((e=>{this.$router.push({name:"transfer-expenses"})}))},getResponse(e){if(e){const e={WSID:this.rows[this.selected_index].WSID};(0,f.XD)(e).then((e=>{(0,h.U)(e.data.message,"positive","top"),this.rows.splice(this.selected_index,1),this.selected_index=null,this.$refs.confirmbox.response=!1,this.validate_GRN()})).catch((e=>{(0,h.j)(e.response.data.message,"negative","top")}))}},update_te(e,o){var t=this.rows[o],l=e;t[l.key]=l.value;const s={TEID:t.TEID,Date:t.Date,Cost:"",DriverID:""};(0,f.ij)(s).then((e=>((0,h.U)(e.data.message,"positive","top"),!0))).catch((e=>((0,h.j)(e.response.data.message,"negative","top"),this.rows=[],this.fetch_rows(),!1)))},update_transfered_count(e,o){var t=this.rows[o],l=e;t[l.key]=l.value;const s={newtransferdCount:t.INCount,WSID:t.WSID};s.newtransferdCount<1?((0,h.j)("Transfered Quantity cant be less than 1"),this.rows=[],this.fetchRows()):(0,f.LE)(s).then((e=>((0,h.U)(e.data.message,"positive","top"),!0))).catch((e=>((0,h.j)(e.response.data.message,"negative","top"),this.rows=[],this.fetchRows(),!1)))},show_dialog_box(e){this.$refs.confirmbox.message=`${this.rows[e].ItemType} `,this.$refs.confirmbox.confirm=!0,this.selected_index=e},wrapCsvValue(e,o){let t=void 0!==o?o(e):e;return t=void 0===t||null===t?"":String(t),t=t.split('"').join('""'),`"${t}"`},exportTable(){const e=[this.columns.map((e=>this.wrapCsvValue(e.label)))].concat(this.rows.map((e=>this.columns.map((o=>this.wrapCsvValue("function"===typeof o.field?o.field(e):e[void 0===o.field?o.name:o.field],o.format))).join(",")))).join("\r\n"),o=(0,m.Z)("table-export.csv",e,"text/csv");!0!==o&&(0,h.j)("Browser denied file download...")}},mounted(){this.fetchRows()}};var b=t(3414),g=t(3243),D=t(2025),y=t(8886),_=t(8516),C=t(2165),x=t(8186),I=t(3884),k=t(1289),T=t(2651),V=t(4842),q=t(7518),U=t.n(q);v.render=c;const W=v;U()(v,"components",{QItem:b.Z,QTable:g.Z,QSpace:D.Z,QToggle:y.Z,QSelect:_.Z,QBtn:C.Z,QTr:x.Z,QTd:I.Z,QPopupEdit:k.Z,QDate:T.Z,QInput:V.Z})}}]);